% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/optimize_theta_identification.R
\name{optimize_theta_identification}
\alias{optimize_theta_identification}
\title{Optimize Theta (Heteroskedasticity Parameter) Identification}
\usage{
optimize_theta_identification(
  i,
  n_pcs = 4,
  pc_data,
  yields,
  term_premia,
  maturities,
  tau_bounds = c(0, 0.99),
  weight_bounds = 2,
  n_starts = 20,
  algorithm = "NLOPT_LN_COBYLA",
  verbose = FALSE
)
}
\arguments{
\item{i}{Integer specifying the maturity index (column) to analyze.
Must be between 1 and ncol(yields). Corresponds to maturity in years
for ACM dataset (i=1 is 1-year, i=2 is 2-year, ..., i=10 is 10-year).
The maturity index determines which yield curve point is used in the analysis.}

\item{n_pcs}{Integer specifying the number of principal components to use.
Must be between 1 and 6. Default is 4 following Adrian, Crump, and Moench (2013).
The choice of n_pcs represents a trade-off between capturing yield curve variation
and maintaining computational stability. More components capture more variation
but may lead to overfitting in finite samples.}

\item{pc_data}{Matrix of principal components (T x K) where K >= n_pcs}

\item{yields}{Matrix of yields (T x M) where M is number of maturities}

\item{term_premia}{Matrix of term premia (T x M)}

\item{maturities}{Vector of all available maturities}

\item{tau_bounds}{Vector of length 2 with bounds for tau (default c(0, 0.99))}

\item{weight_bounds}{Scalar bound for weights (default 2, so -2 <= w <= 2)}

\item{n_starts}{Number of random starting points for multi-start optimization (default 20)}

\item{algorithm}{Optimization algorithm (default "COBYLA")}

\item{verbose}{Logical, whether to print progress (default FALSE)}
}
\value{
List containing:
\item{maturity}{The maturity used}
\item{n_pcs}{Number of PCs used (J)}
\item{tau_opt}{Optimal tau value}
\item{optimal_weights}{Optimal PC weights (normalized)}
\item{theta_lower}{Lower bound of identified set for theta}
\item{theta_upper}{Upper bound of identified set for theta}
\item{interval_width}{Width of the identified interval}
\item{objective_value}{Optimal objective function value}
\item{convergence}{Convergence status from optimizer}
\item{time_elapsed}{Computation time in seconds}
\item{A}{Quadratic coefficient A}
\item{B}{Quadratic coefficient B}
\item{C}{Quadratic coefficient C}
\item{discriminant}{B^2 - 4AC}
}
\description{
Solves the optimization problem P(i,J) to identify the heteroskedasticity
parameter theta_i for a given maturity using J principal components.
This function finds the optimal tau and PC weights that minimize
the distance between the two roots of the quadratic equation.
}
