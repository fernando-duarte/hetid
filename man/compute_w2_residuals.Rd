% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_w2_residuals.R
\name{compute_w2_residuals}
\alias{compute_w2_residuals}
\title{Compute Reduced Form Residuals for Y2 Variables}
\usage{
compute_w2_residuals(
  yields,
  term_premia,
  maturities = 1:9,
  n_pcs = 4,
  pcs = NULL,
  return_df = FALSE,
  dates = NULL
)
}
\arguments{
\item{yields}{Data frame with yield columns (y1, y2, ..., y10)}

\item{term_premia}{Data frame with term premium columns (tp1, tp2, ..., tp10)}

\item{maturities}{Vector of maturities to process (default: 1:9)}

\item{n_pcs}{Number of principal components to use (default: 4)}

\item{pcs}{Matrix of principal components (T x n_pcs). If NULL, loads from package data.}

\item{return_df}{Logical, if TRUE returns a data frame with dates (default FALSE).}

\item{dates}{Optional vector of dates. If NULL and return_df = TRUE, will attempt to
extract from data.}
}
\value{
If return_df = FALSE, returns a list containing:
\describe{
\item{residuals}{List of residual vectors, one for each maturity}
\item{fitted}{List of fitted value vectors}
\item{coefficients}{Matrix of regression coefficients (maturities x predictors)}
\item{r_squared}{Vector of R-squared values for each maturity}
\item{n_obs}{Number of observations used in each regression}
}
If return_df = TRUE, returns a data frame with columns:
\describe{
\item{date}{Date column}
\item{maturity}{Maturity identifier}
\item{residuals}{Residuals \eqn{W_{2,t+1}}}
\item{fitted}{Fitted values from the regression}
}
}
\description{
Computes residuals W_\{2,t+1\}^\{(i)\} from regressing Y_\{2,t+1\}^\{(i)\} variables
(SDF innovations) on principal components and a constant.
}
\details{
For each maturity i, computes Y_\{2,t+1\}^\{(i)\} as the SDF innovation:
\eqn{Y_{2,t+1}^{(i)} = E_{t+1}[SDF_{t+1+i}] - E_t[SDF_{t+1+i}]}

This is computed using the compute_sdf_innovations() function.
Then regresses Y_\{2,t+1\}^\{(i)\} on PC_t to get residuals W_\{2,t+1\}^\{(i)\}.
}
\examples{
\dontrun{
# Load ACM data
acm_data <- extract_acm_data()
yields <- acm_data[, grep("^y", names(acm_data))]
term_premia <- acm_data[, grep("^tp", names(acm_data))]

# Compute residuals for all maturities
res_y2 <- compute_w2_residuals(yields, term_premia)

# Compute for specific maturities only
res_y2_short <- compute_w2_residuals(yields, term_premia, maturities = 1:3)

# Get results as data frame
res_y2_df <- compute_w2_residuals(yields, term_premia,
  maturities = c(3, 5, 7),
  return_df = TRUE
)
head(res_y2_df)
}
}
