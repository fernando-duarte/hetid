% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/solve_gamma_quadratic.R
\name{solve_gamma_quadratic}
\alias{solve_gamma_quadratic}
\title{Solve Quadratic Equation for Gamma_1}
\usage{
solve_gamma_quadratic(pc_j, w1, w2, tau, use_t_minus_1 = TRUE, dates = NULL)
}
\arguments{
\item{pc_j}{Numeric vector, time series of PC_jt (principal component j at time t)}

\item{w1}{Numeric vector, time series of W_1,t+1 (reduced form residual for Y1)}

\item{w2}{Numeric vector, time series of W_2,i,t+1 (reduced form residual for Y2 at maturity i)}

\item{tau}{Numeric, parameter between 0 and 1}

\item{use_t_minus_1}{Logical, if TRUE uses T-1 in denominators (default), if FALSE uses T}

\item{dates}{Optional vector of dates corresponding to the time series. If provided, the function
will return information about which dates were used after removing NA values.}
}
\value{
A named list containing:
\describe{
\item{roots}{Numeric vector of length 2 containing the roots gamma_1^(1) and gamma_1^(2),
ordered so the root with smallest real part is first}
\item{coefficients}{Named vector with quadratic coefficients a, b, c where
a\emph{gamma_1^2 + b}gamma_1 + c = 0}
\item{discriminant}{The discriminant b^2 - 4ac}
\item{components}{List containing all computed covariances and variances
used in the calculation}
\item{dates_used}{If dates parameter was provided, returns the dates corresponding to
observations used after removing NA values}
}
}
\description{
Finds the roots of the quadratic equation in gamma_1 given time series of PC_jt,
W_1,t+1, W_2,i,t+1, and a parameter tau.
}
\details{
The function solves the quadratic equation:
a\emph{gamma_1^2 + b}gamma_1 + c = 0

where:
\itemize{
\item a = (1 - tau^2)
\item b = 2*(Cov(W1\emph{W2, W2^2)/Var(W2^2) * tau^2 - Cov(W1}W2, PC_j)/Cov(W2^2, PC_j))
\item c = \[Cov(W1\emph{W2, PC_j)\]^2 / \[Cov(W2^2, PC_j)\]^2 - Var(W1}W2)/Var(W2^2) * tau^2
}

The covariances and variances are computed using empirical estimators with either
T-1 or T in the denominator based on use_t_minus_1.
}
\examples{
\dontrun{
# Generate sample data
set.seed(123)
n <- 100
pc_j <- rnorm(n)
w1 <- rnorm(n)
w2 <- rnorm(n)

# Solve quadratic for tau = 0.5
result <- solve_gamma_quadratic(pc_j, w1, w2, tau = 0.5)
print(result$roots)

# Use T instead of T-1 in denominators
result_t <- solve_gamma_quadratic(pc_j, w1, w2, tau = 0.5, use_t_minus_1 = FALSE)

# With dates to track which observations were used
dates <- seq(as.Date("2020-01-01"), length.out = n, by = "month")
result_dates <- solve_gamma_quadratic(pc_j, w1, w2, tau = 0.5, dates = dates)
print(result_dates$dates_used) # Shows dates after removing NA values
}

}
